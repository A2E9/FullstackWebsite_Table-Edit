<main>
  <p-table
    #dt
    [columns]="selectedColumns"
    [value]="persons"
    responsiveLayout="scroll"
    [paginator]="true"
    [rows]="10"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [globalFilterFields]="[cols[0].field, cols[1].field, cols[2].field]"
    appWithUnsort
    selectionMode="single"  (onRowSelect)="onRowSelect($event)"
  >
    <ng-template pTemplate="caption">
      <p-multiSelect
        [options]="cols"
        [(ngModel)]="selectedColumns"
        (onChange)="saveInLocalStorage()"
        optionLabel="header"
        selectedItemsLabel="{0} columns selected"
        [style]="{ minWidth: '200px' }"
        placeholder="Choose Columns"
      ></p-multiSelect>
      <div
        class="flex yellow-container"
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
        "
      >
        <h5 style="font-size: larger">Personen Table</h5>
        <span class="p-input-icon-left ml-auto">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            (input)="dt.filterGlobal($any($event.target).value, 'contains')"
            placeholder="Search keyword"
          />
        </span>
      </div>
    </ng-template>
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th
          *ngFor="let col of columns"
          [pSortableColumn]="col.field"
          style="white-space: nowrap"
        >
          {{ col.header }}
          <p-sortIcon [field]="col.field"></p-sortIcon>
        </th>
      </tr>
      <tr>
        <th *ngFor="let col of columns" [ngSwitch]="col.field" >
          <div
            *ngIf="
              !(
                col.field === 'nationalitaet' ||
                col.field == 'geschlecht' ||
                col.field == 'anrede' ||
                col.field == 'familienstand' ||
                col.field == 'geburtsdatum'
              )
            "
          >
            <p-columnFilter
              *ngSwitchCase="col.field"
              type="text"
              [field]="col.field"
              [placeholder]="col.header"
            ></p-columnFilter>
          </div>
          <p-columnFilter 
          *ngSwitchCase="'geburtsdatum'" >
            <ng-template pTemplate="filter" type="date">
            <p-calendar
              *ngSwitchCase="'geburtsdatum'"
              [placeholder]="col.header"
              dateFormat="dd.mm.yy"
              (onSelect)="dt.filter(convertDate($event), 'geburtsdatum', 'equals')"
              [style]="{ width: '135px' }"
            ></p-calendar>
            </ng-template>
          </p-columnFilter>


          <p-multiSelect
            *ngSwitchCase="'nationalitaet'"
            placeholder="NationalitÃ¤t"
            [options]="AllNationalitaet"
            [style]="{ 'max-width': '135px' }"
            
            selectedItemsLabel="{0} items selected"
            [style]="{ width: '100%' }"
            (onChange)="dt.filter($event.value, col.field, 'in')"
          ></p-multiSelect>

          <p-multiSelect
            *ngSwitchCase="'anrede'"
            placeholder="Anrede"
            [options]="allAnrede"
            [style]="{ 'max-width': '135px' }"
            [(ngModel)]="selectedG"
            selectedItemsLabel="{0} items selected"
            [style]="{ width: '100%' }"
            (onChange)="dt.filter($event.value, col.field, 'in')"
          ></p-multiSelect> 

          <p-multiSelect
            *ngSwitchCase="'geschlecht'"
            placeholder="Alle"
            [options]="allGeschlecht"
            [style]="{ 'max-width': '135px' }"
            [(ngModel)]="selectedG"
            selectedItemsLabel="{0} items selected"
            [style]="{ width: '100%' }"
            (onChange)="dt.filter($event.value, col.field, 'in')"
          ></p-multiSelect>
          
          <p-multiSelect
            *ngSwitchCase="'familienstand'"
            placeholder="Alle"
            [options]="allStatus"
            [style]="{ 'max-width': '135px' }"
            [(ngModel)]="selectedG"
            selectedItemsLabel="{0} items selected"
            [panelStyle]="{ minWidth: '12em' }"
            (onChange)="dt.filter($event.value, col.field, 'in')"
          ></p-multiSelect>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns" >
      <tr >
        <td *ngFor="let col of columns" style="white-space: nowrap"  [pSelectableRow]="rowData">
          {{ rowData[col.field] }}
        </td>
      </tr>
    </ng-template>
  </p-table>
</main>
